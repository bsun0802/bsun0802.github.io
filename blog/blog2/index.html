<!DOCTYPE html>

<html lang="en-us"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo&family=Noto+Serif+JP&family=Cormorant+Garamond&family=Libre+Baskerville&family=Source+Serif+Pro&family=Crimson+Text&family=Inter&family=Crimson+Pro&family=Literata&family=Ubuntu+Mono&family=Inter&family=Roboto">
    <link rel="stylesheet" type="text/css" href="/css/style.css">

    
    

    <title>Bo Sun | Facebook AI | How to Read STAR (RNA-seq aligner) output</title>


    

</head><body class="container d-flex flex-column min-vh-100">

<div class="blog_nav_bar secondary_font ">
    
    
    <a class="navbar-brand" href="/">about</a>
    
    
    
    <a class="navbar-brand" href="/blog">Â« all posts</a>
    
    
</div>



<h3>
    <a class="title" href="/blog/blog2/">How to Read STAR (RNA-seq aligner) output</a>
</h3>

<div class="reading_time secondary_font text-muted ">
    <span>
        Jun 7 2019 Â· 4 min read
    </span>

</div>




<div class="tags_navigation">
    
    <a class="tag" href="/tags/RNA-seq/">#RNA-seq</a>
    
    <a class="tag" href="/tags/Bioinformatics/">#Bioinformatics</a>
    
</div>


<p>In this post, I&rsquo;m gonna show you how to read the <code>Log.final.out</code> from RNA-seq aligner <a href="https://github.com/alexdobin/STAR">STAR</a>.</p>
<div class="toc ">
    <div>
        <strong>Table of Contents</strong>
    </div>
    <div>
        
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#background">Background</a></li>
        <li><a href="#goal-of-this-post">Goal of this post</a></li>
        <li><a href="#logfinalout">Log.final.out</a></li>
        <li><a href="#break-it-down">Break it down</a></li>
        <li><a href="#wrap-up">Wrap up</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>
<h2 id="background">Background</h2>
<p>For most of beginner Bioinformaticians, students, including myself back then, tend to apply those reads mappers blindly and head into the downstream analysis. Basically run with the default parameters, and care less about:</p>
<ul>
<li>the quality of the library</li>
<li>the output Log-files generated by the end of the mapping</li>
</ul>
<p>But when the downstream profiling went south, went back to discover something wrong at the beginning(reads mapping) would be a waste of time and energy ðŸ˜µ.<br>
I was once in the above situation, a clustering analysis went quite far and showed sense of a complete wrongness. And I had to go back and find that the reads contains <a href="https://www.illumina.com/science/sequencing-method-explorer/kits-and-arrays/umi.html">UMIs(Unique-Molecules-Identifier)</a>.</p>
<h2 id="goal-of-this-post">Goal of this post</h2>
<p>In this post, I would decipher STAR&rsquo;s <code>Log.final.out</code> line by line, to show how can we diagnose the library and the mapping and may identify problems as soon as possible.</p>
<h2 id="logfinalout">Log.final.out</h2>
<pre tabindex="0"><code>    &gt; less Log.final.out
                                 Started job on |       May 11 15:53:47
                             Started mapping on |       May 11 15:54:07
                                    Finished on |       May 11 15:56:26
       Mapping speed, Million of reads per hour |       32.58

                          Number of input reads |       1257924
                      Average input read length |       51
                                    UNIQUE READS:
                   Uniquely mapped reads number |       317851
                        Uniquely mapped reads % |       25.27%
                          Average mapped length |       44.03
                       Number of splices: Total |       11046
            Number of splices: Annotated (sjdb) |       8743
                       Number of splices: GT/AG |       9717
                       Number of splices: GC/AG |       422
                       Number of splices: AT/AC |       2
               Number of splices: Non-canonical |       905
                      Mismatch rate per base, % |       0.95%
                         Deletion rate per base |       0.00%
                        Deletion average length |       1.11
                        Insertion rate per base |       0.01%
                       Insertion average length |       1.13
                             MULTI-MAPPING READS:
        Number of reads mapped to multiple loci |       120440
             % of reads mapped to multiple loci |       9.57%
        Number of reads mapped to too many loci |       7043
             % of reads mapped to too many loci |       0.56%
                                  UNMAPPED READS:
       % of reads unmapped: too many mismatches |       0.00%
                 % of reads unmapped: too short |       63.99%
                     % of reads unmapped: other |       0.60%
                                  CHIMERIC READS:
                       Number of chimeric reads |       0
                            % of chimeric reads |       0.00%
</code></pre><h2 id="break-it-down">Break it down</h2>
<p>Above is a single-end STAR mapping Log.final.out. It contains metadata like timestamp, mapping speed. Statistics like read count, avg. read length. Let&rsquo;s examine some important metrics.</p>
<ul>
<li><input disabled="" type="checkbox"> Uniquely mapped reads -&gt; 25.27%</li>
</ul>
<p>this is quite low and therefore raise my attention for a double-check on posible reasons.</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Average mapped length -&gt; 44.03. Good since it was close to the avg.read length.</li>
<li><input checked="" disabled="" type="checkbox"> Number of splices. -&gt; Good since number of splices were dominated by annotated and canonical splices.</li>
<li><input checked="" disabled="" type="checkbox"> Mismatch rate per base -&gt; 0.95%. Good, tho a tiny bit on the high side, 1.11%. 0.5-0.8% for good libraries,</li>
<li><input checked="" disabled="" type="checkbox"> Insertion and Deletions -&gt; Good, in/dels were low.</li>
<li><input checked="" disabled="" type="checkbox"> Multi-mapping reads -&gt; 9.57%. Well this depends on your analysis, you can choose to use uniquely mapped reads for simplicity. But there are tools that my re-estimate the expression by incorporating multi-mapped reads.</li>
<li><input checked="" disabled="" type="checkbox"> Number of reads mapped to too many loci: 0.56% -&gt; Good, default for &ldquo;too many&rdquo; is 10 loci. 0.56% is not missing too much.</li>
</ul>
<p>Here comes the bad one:</p>
<ul>
<li><input disabled="" type="checkbox"> reads unmapped: too short -&gt; <strong>63.99%</strong></li>
</ul>
<p>This is for sure unusual, and you may be confused that the avg.length are close to read-length, then why too many reads are <em>&ldquo;too short&rdquo;</em>?<br>
Actually <em>too short</em> is poorly labeled, it stands for &ldquo;<em>alignment too short</em>&rdquo;. This could either happen for normal length reads that are not mapping well or reads that are literally too short(e.g., over-trimmed reads). You can increase the number of mapped reads by relaxing the requirements on mapped length.<br>
Like with the following options, default is 0.66, means 2/3 bps should be mapped, see <a href="https://github.com/alexdobin/STAR/blob/master/doc/STARmanual.pdf">STAR manual</a>:</p>
<ul>
<li><code>--outFilterScoreMinOverLread 0.3</code></li>
<li><code>--outFilterMatchNminOverLread 0.3</code></li>
</ul>
<h2 id="wrap-up">Wrap up</h2>
<p>One of the large issue for bioinformatics discoveries is reproducibility. One should be consistent and accurate when performing analysis. So check and make sure the reads mapper (for example STAR) is performing reasonably before you head into subsequent analysis.</p>


<footer class="mt-auto d-flex justify-content-center text-muted small secondary_font">
    <span class="text-muted">Copyright (c) 2021, Bo Sun,
        <a class="text-muted" href="https://github.com/hadisinaee/avicenna" target="_blank"> created by Avicenna
            (MIT)</a>
    </span>
</footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js"></script>
<script>
    feather.replace()
</script></body>

</html>